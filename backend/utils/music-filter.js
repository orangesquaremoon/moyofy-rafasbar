// backend/utils/music-filter.js
// MOYOFY PREMIUM v2.0 - SISTEMA INTELIGENTE DE FILTRADO POR ARTISTAS
// Rafa's Bar - Versión Premium: Solo artistas/bandas permitidos y prohibidos explícitos
// ================================================================

// ✅ FUNCIÓN DE NORMALIZACIÓN (elimina acentos, símbolos y convierte a minúsculas)
const normalize = s =>
  String(s || '')
    .normalize('NFD')
    .replace(/[\u0300-\u036f]/g, '')
    .replace(/[^a-z0-9\s&\/\-\.]/gi, '')
    .toLowerCase();

// ✅ LISTA DE ARTISTAS PERMITIDOS (Rock, Alternativo, Indie, Clásicos)
const ALLOWED_ARTISTS = new Set([
  // Rock Clásico y Hard Rock
  "Led Zeppelin",
  "Pink Floyd",
  "The Velvet Underground",
  "The Stooges",
  "MC5",
  "Captain Beefheart",
  "Frank Zappa",
  "King Crimson",
  "Yes",
  "Genesis",
  "Emerson, Lake & Palmer",
  "Jethro Tull",
  "Van Der Graaf Generator",
  "Gentle Giant",
  "Caravan",
  "Soft Machine",
  "Can",
  "Kraftwerk",
  "Neu!",
  "Faust",
  "Tangerine Dream",
  "Amon Düül II",
  "Hawkwind",
  "The Doors",
  "Love",
  "The Yardbirds",
  "Jefferson Airplane",
  "The Grateful Dead",
  "Big Brother and the Holding Company",
  "Quicksilver Messenger Service",
  "Moby Grape",
  "Buffalo Springfield",
  "The Byrds",
  "The Flying Burrito Brothers",
  "New Riders of the Purple Sage",
  "Poco",
  "The Band",
  "Little Feat",
  "Pure Prairie League",
  "The Ozark Mountain Daredevils",
  "Firefall",
  "The Outlaws",
  "Charlie Daniels Band",
  "Molly Hatchet",
  "The Marshall Tucker Band",
  "Black Oak Arkansas",
  "Grand Funk Railroad",
  "Steppenwolf",
  "Sly and the Family Stone",
  "James Brown",
  "Little Richard",
  "Chuck Berry",
  "Bo Diddley",
  "Buddy Holly",
  "Roy Orbison",
  "Fats Domino",
  "Bill Haley & His Comets",
  "The Crickets",
  "The Troggs",
  "The Hollies",
  "The Searchers",
  "The Lovin' Spoonful",
  "The Mamas & The Papas",
  "The Association",
  "The Left Banke",
  "Strawberry Alarm Clock",
  "Vanilla Fudge",
  "Blue Cheer",
  "The New York Dolls",
  "Mott the Hoople",
  "The Faces",
  "Small Faces",
  "Humble Pie",
  "Free",
  "Bad Company",
  "Uriah Heep",
  "Wishbone Ash",
  "The Strawbs",
  "Camel",
  "Focus",
  "Blood, Sweat & Tears",
  "Tower of Power",
  "War",
  "The Isley Brothers",
  "Funkadelic",
  "The Meters",
  "Booker T. & the M.G.'s",
  "Curtis Mayfield",
  "Otis Redding",
  "Aretha Franklin",
  "Stevie Ray Vaughan",
  "John Mayall & the Bluesbreakers",
  "Cream",
  "Fleetwood Mac (Peter Green era)",
  "Ten Years After",
  "Procol Harum",
  "Family",
  "Spooky Tooth",
  "The Move",
  "Mud",
  "The Sensational Alex Harvey Band",
  "Nazareth",
  "Blue Öyster Cult",
  "Mountain",
  "Three Dog Night",
  "Little River Band",
  "Seals and Crofts",
  "The Carpenters",
  "Gerry Rafferty",
  "Badfinger",
  "The Raspberries",
  "Todd Rundgren",
  "Harry Nilsson",
  "Randy Newman",
  "Warren Zevon",
  "Al Stewart",
  "Nick Drake",
  "Richard Thompson",
  "Fairport Convention",
  "Pentangle",
  "Steeleye Span",
  "The Incredible String Band",
  "Sandy Denny",
  "Bert Jansch",
  "John Martyn",
  "Tim Buckley",
  "Ry Cooder",
  "Taj Mahal",
  "Canned Heat",
  "Johnny Winter",
  "Edgar Winter",
  "Gram Parsons",
  "Eagles of Death Metal",
  "Fishbone",
  "Primus",
  "Living Colour",
  "Rancid",
  "NOFX",
  "Bad Religion",
  "Descendents",
  "The Vandals",
  "Weezer",
  "The Replacements",
  "Hüsker Dü",
  "The Minutemen",
  "Black Flag",
  "Dead Kennedys",
  "Minor Threat",
  "Bad Brains",
  "Fugazi",
  "The Jesus Lizard",
  "Shellac",
  "Big Black",
  "Sleater-Kinney",
  "Pavement",
  "Guided by Voices",
  "Yo La Tengo",
  "Built to Spill",
  "Modest Mouse",
  "Slint",
  "Don Caballero",
  "Neurosis",
  "Swans",
  "Scratch Acid",
  "Butthole Surfers",
  "The Melvins",
  "Tad",
  "The Screaming Trees",
  "L7",
  "Babes in Toyland",
  "Hole",
  "PJ Harvey",
  "Quicksand",
  "Jawbox",
  "Shudder to Think",
  "The Dismemberment Plan",
  "At the Drive-In",
  "Sparta",
  "Glassjaw",
  "Cave In",
  "Botch",
  "Coalesce",
  "Isis",
  "Pelican",
  "Russian Circles",
  "Mono",
  "This Will Destroy You",
  "If These Trees Could Talk",
  "Caspian",
  "Jakob",
  "65daysofstatic",
  "God Is an Astronaut",
  "Maybeshewill",
  "And So I Watch You From Afar",
  "Do Make Say Think",
  "The Sea and Cake",
  "Gastr del Sol",
  "Liz Phair",
  "Cat Power",
  "The Raincoats",
  "The Slits",
  "X",
  "The Gun Club",
  "The Cramps",
  "The Chameleons",
  "The Sound",
  "The Comsat Angels",
  "Bauhaus",
  "The Mission",
  "Fields of the Nephilim",
  "Christian Death",
  "45 Grave",
  "Specimen",
  "Alien Sex Fiend",
  "Sex Gang Children",
  "The Cult",
  "The Alarm",
  "Big Country",
  "The Waterboys",
  "The Pogues",
  "The Men They Couldn't Hang",
  "The Levellers",
  "Chumbawamba",
  "The Exploited",
  "GBH",
  "The Business",
  "Cock Sparrer",
  "Sham 69",
  "Stiff Little Fingers",
  "The Undertones",
  "The Ruts",
  "Wire",
  "Gang of Four",
  "The Fall",
  "Public Image Ltd",
  "Magazine",
  "XTC",
  "Squeeze",
  "Graham Parker",
  "Ian Dury and the Blockheads",
  "Toots and the Maytals",
  "Jimmy Cliff",
  "Desmond Dekker",
  "The Skatalites",
  "Bob Marley and the Wailers",
  "Peter Tosh",
  "Burning Spear",
  "Steel Pulse",
  "Aswad",
  "Dexys Midnight Runners",
  "The Jam",
  "Adam and the Ants",
  "Visage",
  "Ultravox",
  "OMD",
  "Soft Cell",
  "Yazoo",
  "The Human League",
  "ABC",
  "Heaven 17",
  "Thompson Twins",
  "Howard Jones",
  "Thomas Dolby",
  "Gary Numan",
  "The Buggles",
  "Japan",
  "Television",
  "The Runaways",
  "The Go-Go's",
  "The Bangles",
  "Cyndi Lauper",
  "Fleetwood Mac",
  "Stevie Nicks",
  "Emmylou Harris",
  "Dolly Parton",
  "Johnny Cash",
  "June Carter Cash",
  "Merle Haggard",
  "Townes Van Zandt",
  "Guy Clark",
  "Steve Earle",
  "Lucinda Williams",
  "Ryan Adams",
  "The Jayhawks",
  "Uncle Tupelo",
  "Son Volt",
  "Wilco",
  "Drive-By Truckers",
  "Old 97's",
  "Whiskeytown",
  "The Bottle Rockets",
  "The Hold Steady",
  "The Gaslight Anthem",
  "Lucero",
  "Against Me!",
  "The Black Lips",
  "Thee Oh Sees",
  "Ty Segall",
  "King Gizzard & the Lizard Wizard",
  "Pond",
  
  // Artistas adicionales de la segunda lista
  "A Flock of Seagulls",
  "ABBA",
  "Ace of Base",
  "Adam Lambert",
  "Aerosmith",
  "Alabama Shakes",
  "Alejandra Guzmán",
  "Alice Cooper",
  "Alice In Chains",
  "All-4-One",
  "Allison",
  "Alux Nahual",
  "America",
  "American Authors",
  "Amistades Peligrosas",
  "Anabantha",
  "Andrés Calamaro",
  "Ana Torroja",
  "Arctic Monkeys",
  "Arcángel",
  "Asesino",
  "Aterciopelados",
  "Aventura",
  "Avett Brothers",
  "B 52’s",
  "Babymetal",
  "Bang Tango",
  "Bananafishbones",
  "Barón Rojo",
  "BB King",
  "Beastie Boys",
  "Bee Gees",
  "Belanova",
  "Ben Harper",
  "Bersuit Vergarabat",
  "Big & Rich",
  "Big Audio Dynamite",
  "Big Star",
  "Billy Idol",
  "Billy Joel",
  "Black Eyed Peas",
  "Blondie",
  "Bob Seger & The Silver Bullet Band",
  "Bon Jovi",
  "Bon Iver",
  "Boney M.",
  "Boston",
  "Bow Wow Wow",
  "Boys Like Girls",
  "Bread",
  "Britney Spears",
  "Breaking Benjamin",
  "Brooks & Dunn",
  "Bruce Springsteen and the E Street Band",
  "Bruno Mars",
  "Bryan Adams",
  "Busta Rhymes",
  "Cage the Elephant",
  "Cake",
  "Caifanes",
  "Café Tacvba",
  "Calexico",
  "Camila",
  "Camilo Sesto",
  "Camper Van Beethoven",
  "Cannonball Adderley",
  "Cappella",
  "Carly Rae Jepsen",
  "Cascada",
  "Céu",
  "Cheap Trick",
  "Cher",
  "Chicago",
  "Chic",
  "Chino & Nacho",
  "Cibo Matto",
  "Cinderella",
  "Ciro y los Persas",
  "Clash, The",
  "Collective Soul",
  "Conchita",
  "Conexión",
  "Contrabanda",
  "Counting Crows",
  "Crash Test Dummies",
  "Creedence Clearwater Revival",
  "Crowded House",
  "Cuarteto de Nos",
  "Culture Club",
  "Cyndi Lauper",
  "Daft Punk",
  "Dámaso Pérez Prado",
  "Daughtry",
  "Dayglow",
  "Dead Can Dance",
  "Death Cab for Cutie",
  "Deep Forest",
  "Deep Purple",
  "Def Leppard",
  "De La Soul",
  "Deee-Lite",
  "Del Amitri",
  "Dengue Dengue Dengue",
  "Desakato",
  "Destiny’s Child",
  "Devo",
  "Dexys Midnight Runners",
  "Dido",
  "Diego Torres",
  "Dinosaur Jr en Español",
  "Dio",
  "Dire Straits",
  "Dizzy Mizz Lizzy",
  "DJ Sammy",
  "Dokken",
  "Dolores del Río",
  "Don Henley",
  "Don McLean",
  "Don Omar",
  "Don Tetto",
  "Donna Summer",
  "Doo-Wop All Stars",
  "Dorian",
  "Dover",
  "Duncan Dhu",
  "Duran Duran",
  "D’Mente Común",
  "Dumas",
  "Earth Wind & Fire",
  "Ed Sheeran",
  "Eagles",
  "Electric Light Orchestra",
  "El Gran Silencio",
  "El Canto del Loco",
  "El Cuarteto de Nos",
  "El Tri",
  "Elvis Costello",
  "Elvis Presley",
  "El Último de la Fila",
  "Emerson, Lake & Palmer",
  "Engenheiros do Hawaii",
  "Enjambre",
  "Enrique Bunbury",
  "En Vogue",
  "Erasure",
  "Eric Clapton",
  "Estopa",
  "Eurythmics",
  "Europe",
  "Evanescence",
  "Evan Taubenfeld",
  "Everclear",
  "Everly Brothers, The",
  "Extreme",
  "Faith Hill",
  "Faith No More",
  "Fall Out Boy",
  "Fangoria",
  "Fatboy Slim",
  "Fifth Harmony",
  "Fine Young Cannibals",
  "Firehouse",
  "Fito Páez",
  "Fitz and The Tantrums",
  "Florence + The Machine",
  "Flyleaf",
  "Fobia",
  "Foster The People",
  "Four Tops",
  "Franz Ferdinand",
  "Fugees",
  "Gabby’s World",
  "Gabinete Caligari",
  "Genesis",
  "Gentle Giant",
  "Ginebras",
  "Gipsy Kings",
  "Girl in a Coma",
  "Glen Hansard",
  "Gloria Estefan",
  "Gnarls Barkley",
  "Go-Go’s",
  "Godsmack",
  "Goo Goo Dolls",
  "Gordon Lightfoot",
  "Gorillaz",
  "Grateful Dead",
  "Green Day",
  "Guns N’ Roses",
  "Haddaway",
  "Haim",
  "Hall & Oates",
  "Happy Mondays",
  "Heart",
  "Heartless Bastards",
  "Heaven 17",
  "Hermética",
  "Hilary Duff",
  "Hinds",
  "Hombres G",
  "Hoobastank",
  "Hot Chip",
  "Hootie & The Blowfish",
  "Huey Lewis & The News",
  "Human League",
  "Iggy Pop",
  "Illya Kuryaki and the Valderramas",
  "Incubus",
  "INXS",
  "Interpol",
  "Iron Butterfly",
  "Iron Maiden",
  "Izal",
  "Jamestown Revival",
  "James Taylor",
  "Jamiroquai",
  "Janis Joplin",
  "Jason Mraz",
  "Jawbreaker",
  "Jefferson Airplane",
  "Jefferson Starship",
  "Jennifer Lopez",
  "Jerry Lee Lewis",
  "Jesse & Joy",
  "Jessie J",
  "Jethro Tull",
  "Jimi Hendrix Experience",
  "Joan Jett & The Blackhearts",
  "Joe Cocker",
  "Joe Jackson",
  "John Mayer",
  "John Mellencamp",
  "Jonas Brothers",
  "José González",
  "Josh Groban",
  "Journey",
  "Joy Division",
  "Joywave",
  "Juan Gabriel",
  "Julieta Venegas",
  "Justice",
  "K-Ci & JoJo",
  "Kaiser Chiefs",
  "Kali Uchis",
  "Kansas",
  "Kanye West",
  "Kasabian",
  "Keane",
  "Kelis",
  "Kelly Clarkson",
  "Kings of Convenience",
  "Kings of Leon",
  "Kiss",
  "Korn",
  "Kraftwerk",
  "La Casa Azul",
  "La Ley",
  "La Maldita Vecindad y los Hijos del Quinto Patio",
  "La Oreja de Van Gogh",
  "La Paloma",
  "La Renga",
  "La Vida Bohème",
  "Labrinth",
  "Lady Gaga",
  "Lady Smith Black Mambazo",
  "Lana Del Rey",
  "Las Ketchup",
  "LCD Soundsystem",
  "Leiva",
  "Lenny Kravitz",
  "León Benavente",
  "LeAnn Rimes",
  "Leonard Cohen",
  "Limp Bizkit",
  "Linkin Park",
  "Little Big Town",
  "LMFAO",
  "London Grammar",
  "Lorde",
  "Los Auténticos Decadentes",
  "Los Bunkers",
  "Los Cadillacs",
  "Los Enanitos Verdes",
  "Los Enemigos",
  "Los Fabulosos Cadillacs",
  "Los Mesoneros",
  "Los Planetas",
  "Los Prisioneros",
  "Los Rabanes",
  "Los Rodríguez",
  "Los Secretos",
  "Los Suaves",
  "Los Tigres del Norte",
  "Los Tipitos",
  "Lost Frequencies",
  "Lou Reed",
  "Love of Lesbian",
  "Luna",
  "Lynyrd Skynyrd",
  "M83",
  "Mabel",
  "Macaco",
  "Mac DeMarco",
  "Madness",
  "Madonna",
  "Mago de Oz",
  "Mando Diao",
  "Maná",
  "Måneskin",
  "Marillion",
  "Maroon 5",
  "Marvin Gaye",
  "Massive Attack",
  "Matchbox Twenty",
  "Melendi",
  "Men at Work",
  "Metallica",
  "Metric",
  "Michael Bublé",
  "Michael Jackson",
  "Michelle Branch",
  "Midnight Oil",
  "Miley Cyrus",
  "Ministry",
  "Misfits, The",
  "Mitski",
  "Molotov",
  "Mon Laferte",
  "Moonspell",
  "Morrissey",
  "Mötley Crüe",
  "Mumford & Sons",
  "Muse",
  "My Bloody Valentine",
  "My Chemical Romance",
  "Nach",
  "Nanci Griffith",
  "Nato",
  "Neil Young",
  "Never Shout Never",
  "New Kids on the Block",
  "New Order",
  "New Politics",
  "New Radicals",
  "New York Dolls",
  "Nick Cave and the Bad Seeds",
  "Nickelback",
  "Niña Pastori",
  "Nine Inch Nails",
  "Nirvana",
  "No Doubt",
  "No Mercy",
  "No Te Va Gustar",
  "Norah Jones",
  "NSYNC",
  "Oasis",
  "Obús",
  "Of Monsters and Men",
  "OK Go",
  "Olivia Rodrigo",
  "Once Tiros",
  "Orbital",
  "Orchestral Manoeuvres in the Dark",
  "Osibisa",
  "OutKast",
  "Owl City",
  "Ozuna",
  "P.O.D.",
  "Pablo Alborán",
  "Páramo",
  "Paramore",
  "Parliament",
  "Parov Stelar",
  "Pat Benatar",
  "Pat Metheny",
  "Patti Smith",
  "Paul McCartney",
  "Paul Simon",
  "Peaches",
  "Pendulum",
  "Perfect Circle",
  "Peter Gabriel",
  "Pet Shop Boys",
  "Pharrell Williams",
  "Phil Collins",
  "Phoenix",
  "Placebo",
  "Plain White T’s",
  "Platero y Tú",
  "Poison",
  "Pointer Sisters",
  "Pomeroy",
  "Portishead",
  "Puddle of Mudd",
  "Pulp",
  "Queensrÿche",
  "R.E.M.",
  "Rammstein",
  "Rob Zombie",
  "Ratones Paranoicos",
  "Ratt",
  "Ray Charles",
  "Raze",
  "Real Estate",
  "Red Hot Chili Peppers",
  "Redonditos de Ricota",
  "Refused",
  "Reik",
  "Renaissance",
  "Resorte",
  "Ricardo Arjona",
  "Ritchie Valens",
  "Robbie Williams",
  "Roxette",
  "Rush",
  "Sade",
  "Sam Cooke",
  "Sam Smith",
  "Santana",
  "Saratoga",
  "Sarah Brightman",
  "Savatage",
  "Scandal",
  "Sea Wolf",
  "Seal",
  "Selena",
  "Sepultura",
  "Set It Off",
  "Sex Pistols",
  "Shania Twain",
  "Sheila on 7",
  "Sheryl Crow",
  "Shinedown",
  "Sigue Sigue Sputnik",
  "Silverchair",
  "Simple Minds",
  "Simple Plan",
  "Sinéad O’Connor",
  "Siniestro Total",
  "Siouxsie and the Banshees",
  "Sister Sledge",
  "Ska-P",
  "Slade",
  "Slayer",
  "Sloan",
  "Slowdive",
  "Smashing Pumpkins",
  "Snoop Dogg",
  "Snow Patrol",
  "Social Distortion",
  "Soda Stereo",
  "Soft Cell",
  "Sophie Ellis-Bextor",
  "Soundgarden",
  "Spandau Ballet",
  "Spice Girls",
  "Spoon",
  "St. Vincent",
  "Status Quo",
  "Stealers Wheel",
  "Steely Dan",
  "Steve Miller Band",
  "Stevie Wonder",
  "Sting",
  "Stone Temple Pilots",
  "Story of the Year",
  "Stray Cats",
  "Strokes, The",
  "Styx",
  "Sublime",
  "Suede",
  "Sufjan Stevens",
  "Sugar Ray",
  "Sunny & The Sunglows",
  "Supertramp",
  "Survivor",
  "Suzi Quatro",
  "Swans",
  "System of a Down",
  "Take That",
  "Tame Impala",
  "Tan Biónica",
  "Tears for Fears",
  "Teenage Fanclub",
  "Tequila",
  "Texas",
  "The 1975",
  "The Allman Brothers Band",
  "The Animals",
  "The Archies",
  "The Avett Brothers",
  "The B-52’s",
  "The Band",
  "The Beach Boys",
  "The Beatles",
  "The Black Crowes",
  "The Black Keys",
  "The Breeders",
  "The Cardigans",
  "The Cars",
  "The Chainsmokers",
  "The Church",
  "The Clash",
  "The Cranberries",
  "The Cult",
  "The Cure",
  "The Dandy Warhols",
  "The Doors",
  "The Doobie Brothers",
  "The Eagles",
  "The Edge",
  "The Guess Who",
  "The Head and the Heart",
  "The Jam",
  "The Jesus and Mary Chain",
  "The Killers",
  "The Kinks",
  "The La's",
  "The Libertines",
  "The Lumineers",
  "The Mars Volta",
  "The Mighty Mighty Bosstones",
  "The Monkees",
  "The Moody Blues",
  "The National",
  "The Offspring",
  "The Police",
  "The Pretenders",
  "The Raconteurs",
  "The Rasmus",
  "The Replacements",
  "The Rolling Stones",
  "The Script",
  "The Seeds",
  "The Shins",
  "The Smashing Pumpkins",
  "The Smiths",
  "The Sound",
  "The Stone Roses",
  "The Stranglers",
  "The Strumbellas",
  "The Strokes",
  "The Stooges",
  "The Suicide Commandos",
  "The Supremes",
  "The Temptations",
  "Tool",
  "The The",
  "The Turtles",
  "The Used",
  "The Verve",
  "The Verve Pipe",
  "The War on Drugs",
  "The Weeknd",
  "The White Stripes",
  "The xx",
  "The Zombies",
  "Theory of a Deadman",
  "Thin Lizzy",
  "Thirty Seconds to Mars",
  "Three Days Grace",
  "Thrice",
  "Timbiriche",
  "Tina Turner",
  "TLC",
  "Toby Keith",
  "Toto",
  "Traffic",
  "Train",
  "Travis",
  "Trey Songz",
  "Triana",
  "Tricky",
  "Trixie Whitley",
  "Twenty One Pilots",
  "UB40",
  "U2",
  "Unknown Mortal Orchestra",
  "Van Der Graaf Generator",
  "Van Halen",
  "Van Morrison",
  "Vampire Weekend",
  "Velvet Underground",
  "Veruca Salt",
  "Vetusta Morla",
  "Village People",
  "Warcry",
  "Walk the Moon",
  "White Zombie",
  "Walk Off the Earth",
  "Warren Zevon",
  "Weezer",
  "Wham!",
  "Whitesnake",
  "Wilco",
  "Willie Nelson",
  "Winger",
  "Wolfmother",
  "X Ambassadors",
  "Ximena Sariñana",
  "Yeah Yeah Yeahs",
  "Yes",
  "Yo La Tengo",
  "Young the Giant",
  "ZZ Top",
  "Zoé"
].map(artist => normalize(artist)).filter(Boolean));

// ✅ LISTA DE ARTISTAS PROHIBIDOS (Pop, Reggaeton, K-Pop, etc.)
const FORBIDDEN_ARTISTS = new Set([
  // Pop Internacional
  "taylor swift", "ed sheeran", "ariana grande", "justin bieber", "katy perry",
  "bruno mars", "the weeknd", "billie eilish", "olivia rodrigo", "dua lipa",
  "doja cat", "lizzo", "sia", "kygo", "shakira",
  
  // Pop Latino/Reggaeton
  "enrique iglesias", "luis fonsi", "rosalía", "pablo alboran", "miguel bose",
  "manuel carrasco", "alejandro sanz", "juan es", "maluma", "j balvin",
  "bad bunny", "ozuna", "anuel aa", "karol g", "becky g", "natti natasha",
  "reik", "morat", "camila cabello", "nicky jam", "c tangana", "mala rodriguez",
  "nathy peluso", "farruko", "wisin & yandel", "luis miguel", "daddy yankee",
  "don omar", "tego calderon", "ivy queen", "ricky martin", "marc anthony",
  "jennifer lopez", "thalia", "paulina rubio", "cnco", "prince royce",
  "romeo santos", "aventura", "monchy & alexandra", "frank reyes", "elvis crespo",
  "olga tañon", "sergio vargas", "juan luis guerra", "carlos vives", "sebastian yat",
  "camilo", "feid", "jhay cortez", "sech", "rauw alejandro", "myke towers",
  "lunay", "plan b", "arcangel", "zion & lennox", "chencho corleone", "tainy",
  
  // K-Pop y Otros Géneros No Deseados
  "anitta", "pabllo vittar", "ivete sangalo", "claudia leitte", "gilberto santa rosa",
  "hector lavoe", "willie colon", "celia cruz", "ruben blades", "victor manuelle",
  "la india", "david guetta", "calvin harris", "tiësto", "marshmello", "diplo",
  "skrillex", "major lazer", "the chainsmokers", "avicii", "zedd", "afrojack",
  "martin garrix", "hardwell", "khalid", "drake", "travis scott", "kendrick lamar",
  "cardi b", "nicki minaj", "jay-z", "beyonce", "rihanna", "adele", "celine dion",
  "whitney houston", "mariah carey", "usher", "ne-yo", "alicia keys", "sam smith",
  "shawn mendes", "charlie puth", "miley cyrus", "selena gomez", "demi lovato",
  "lorde", "halsey", "ellie goulding", "jonas brothers", "maroon 5", "pitbull",
  "flo rida", "jason derulo", "sergio mendes", "bts", "blackpink", "exo", "twice",
  "psy", "bigbang", "red velvet", "got7", "nct", "stray kids", "seventeen", "iu",
  "zayn malik", "one direction", "little mix", "spice girls", "backstreet boys",
  "n-sync", "christina aguilera", "fifth harmony", "olly murs", "olivia newton-john",
  "debbie gibson", "erasure", "pet shop boys", "robbie williams", "s club 7",
  "a*teens", "rick astley", "cyndi lauper", "prince", "prince (as pop legend)",
  "madonna", "lady gaga", "sophie ellis-bextor", "clean bandit", "jessie j",
  "paloma faith", "sigala", "years & years", "iggy azalea", "m.i.a.", "ksi",
  "olivia newton john", "olivia newton john (dup)", "garth brooks", "dolly parton",
  "carrie underwood", "blake shelton", "luke bryan", "jason aldean", "eric church",
  "kenny chesney", "tim mcgraw", "faith hill", "post malone", "kanye west",
  "ye", "snoop dogg", "tupac", "notorious b.i.g.", "eminem", "50 cent", "dr. dre",
  "lil wayne", "future", "young thug", "migos", "gorillaz", "gorillaz (hybrid)",
  "enya", "new age artists", "soundtrack pop artists", "disney pop artists",
  "vocal house artists", "eurodance acts", "techno pop acts", "reggaeton producers (general)",
  "salsa artists (general)", "merengue artists (general)", "bachata artists (general)",
  "trap latin (general)", "k-pop mainstream (expanded)"
].map(artist => normalize(artist)).filter(Boolean));

// ✅ FUNCIÓN AUXILIAR PARA BUSCAR TÉRMINOS NORMALIZADOS
function containsAnyNormalized(text, setOfNormalized) {
  if (!text) return false;
  
  // Convertimos el Set a Array para usar .some() (más eficiente)
  return Array.from(setOfNormalized).some(term => {
    if (!term) return false;
    return text.includes(term);
  });
}

// ✅ FUNCIÓN DE FILTRADO PRINCIPAL
function filterMusic(items) {
  if (!Array.isArray(items)) return [];
  
  return items.filter(item => {
    if (!item || !item.snippet) return false;
    
    const title = String(item.snippet.title || '');
    const description = String(item.snippet.description || '');
    const channelTitle = String(item.snippet.channelTitle || '');
    const combined = `${title} ${description} ${channelTitle}`;
    const normalizedCombined = normalize(combined);
    
    // 1. Rechazar si contiene algún artista PROHIBIDO
    if (containsAnyNormalized(normalizedCombined, FORBIDDEN_ARTISTS)) return false;
    
    // 2. Aceptar SOLO si contiene algún artista PERMITIDO
    if (!containsAnyNormalized(normalizedCombined, ALLOWED_ARTISTS)) return false;
    
    return true;
  });
}

// ✅ EXPORTAR FUNCIONES Y SETS
module.exports = { 
  filterMusic, 
  ALLOWED_ARTISTS, 
  FORBIDDEN_ARTISTS 
};